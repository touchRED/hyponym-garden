var seed = "building";

var gifUrl = "http://api.giphy.com/v1/gifs/search?q=" + seed + "&api_key=8lARF0cgG0lY6ZMfZ6n2GEYcoHvXg4WX";
var wordnikKey = "47dccf8be44d27e33e000095fc00800d910779b868e19b1dc";

var words = {};
var imgs = {};

var currentImgs = [];
var imgIndex = 0;
var currentImgElement;
var currentP;

var nextImgs = {};
var nextSynonym;
var nextHypo;
var nextHyper;

var helping = false;

function setup(){
  noCanvas();

  var help = select("#help");
  // help.hide();
  var helpButton = select("i");
  helpButton.mouseClicked(function(){
    if(!helping){
      help.show();
      helping = true;
    }else{
      help.hide();
      helping = false;
    }
  });

  if(window.location.hash.length > 1){
    seed = window.location.hash.slice(1);
    gifUrl = "http://api.giphy.com/v1/gifs/search?q=" + seed + "&api_key=8lARF0cgG0lY6ZMfZ6n2GEYcoHvXg4WX";
  }
  loadJSON(gifUrl, function(giphy){
    currentImgElement = createImg(giphy.data[0].images.downsized.url);
    currentP = createInput(seed);
    // console.log(currentP);
    currentP.changed(function(){
      currentP.elt.blur();
      seed = currentP.elt.value;
      console.log("seed:", seed);
      gifUrl = "http://api.giphy.com/v1/gifs/search?q=" + seed + "&api_key=8lARF0cgG0lY6ZMfZ6n2GEYcoHvXg4WX";
      imgs["synonym"] = [];
      imgs["hyponym"] = [];
      imgs["hypernym"] = [];
      words["synonym"] = [];
      words["hyponym"] = [];
      words["hypernym"] = [];
      imgIndex = 0;
      loadJSON(gifUrl, function(giphy){
        if(giphy.data){
          currentImgElement.elt.src = giphy.data[0].images.downsized.url;
          words["synonym"].push(seed);
          words["hyponym"].push(seed);
          words["hypernym"].push(seed);
          imgs["synonym"].push(giphy.data);
          imgs["hyponym"].push(giphy.data);
          imgs["hypernym"].push(giphy.data);
          currentImgs = giphy.data;
          generateNextWords(seed);
        }else{
          console.log("we failed");
        }
      });
    });
    imgs["synonym"] = [];
    imgs["hyponym"] = [];
    imgs["hypernym"] = [];
    words["synonym"] = [];
    words["hyponym"] = [];
    words["hypernym"] = [];
    nextImgs["synonym"] = [];
    nextImgs["hyponym"] = [];
    nextImgs["hypernym"] = [];
    words["synonym"].push(seed);
    words["hyponym"].push(seed);
    words["hypernym"].push(seed);
    imgs["synonym"].push(giphy.data);
    imgs["hyponym"].push(giphy.data);
    imgs["hypernym"].push(giphy.data);
    currentImgs = giphy.data;
    generateNextWords(seed);
  });
}

function generateGiphyFunction(type){
  return function(giphy){
    if(giphy.data.length > 0){
      nextImgs[type] = giphy.data;
    }else{
      generateWord(words[type][words.length - 1], type);
    }
  }
}

function generateWordnikLink(word){
  return "http://api.wordnik.com:80/v4/word.json/" + word + "/relatedWords?useCanonical=false&relationshipTypes=synonym&limitPerRelationshipType=10&api_key=" + wordnikKey;
}

function generateDataMuseLink(params){
  var queryLink = "http://api.datamuse.com/words?";
  for(var i = 0; i < params.length; i++){
    if(i > 0){
      queryLink += "&";
    }
    queryLink += params[i];
  }
  return queryLink;
}

function generateNextWords(word){
  generateSynonym(word);
  generateHyponym(word);
  generateHypernym(word);
}

function generateWord(word, type){
  if(type == "synonym"){
    generateSynonym(word);
  }else if(type == "hypernym"){
    generateHypernym(word);
  }else if(type == "hyponym"){
    generateHyponym(word);
  }
}

function generateSynonym(word){
  loadJSON(generateWordnikLink(word), function(data){
    if(data[0] && data[0].words && data[0].words.length > 0){
      nextSynonym = data[0].words[floor(random(data[0].words.length))];
    }else{
      nextSynonym = words["synonym"][words["synonym"].length - 1];
    }
    var nextUrl = "http://api.giphy.com/v1/gifs/search?q=" + nextSynonym + "&api_key=8lARF0cgG0lY6ZMfZ6n2GEYcoHvXg4WX";
    loadJSON(nextUrl, generateGiphyFunction("synonym"));
  });
}

function generateHyponym(word){
  loadJSON(generateDataMuseLink(["rel_gen=" + word]), function(data){
    if(data.length > 0){
      nextHypo = data[floor(random(data.length))].word;
    }else{
      nextHypo = words["hyponym"][words["hyponym"].length - 1];
    }
    var nextUrl = "http://api.giphy.com/v1/gifs/search?q=" + nextHypo + "&api_key=8lARF0cgG0lY6ZMfZ6n2GEYcoHvXg4WX";
    loadJSON(nextUrl, generateGiphyFunction("hyponym"));
  });
}

function generateHypernym(word){
  loadJSON(generateDataMuseLink(["rel_spc=" + word]), function(data){
    if(data.length > 0){
      nextHyper = data[floor(random(data.length))].word;
    }else{
      nextHyper = words["hypernym"][words["hypernym"].length - 1];
    }
    var nextUrl = "http://api.giphy.com/v1/gifs/search?q=" + nextHyper + "&api_key=8lARF0cgG0lY6ZMfZ6n2GEYcoHvXg4WX";
    loadJSON(nextUrl, generateGiphyFunction("hypernym"));
  });
}

function mouseReleased(){
  return false;
}

function touchEnded(){
  if(winMouseX > 3 * window.innerWidth / 4){
    imgIndex = 0;
    currentImgElement.elt.src = nextImgs[0].images.downsized.url;
    // currentP.elt.innerText = nextSynonym;
    currentP.elt.value = nextSynonym;
    imgs.push(nextImgs);
    words.push(nextSynonym);
    console.log(words);
    generateSynonym(nextSynonym);
  }else if(winMouseX < window.innerWidth / 4){
    if(words.length > 1){
      words.pop();
      imgs.pop();
      imgIndex = 0;
    }
    currentImgElement.elt.src = imgs[imgs.length - 1][imgIndex].images.downsized.url;
    // currentP.elt.innerText = words[words.length - 1];
    currentP.elt.value = words[words.length - 1];
    generateSynonym(words[words.length - 1]);
  }else{
    if(imgIndex < imgs[imgs.length - 1].length - 1){
      imgIndex++;
    }else{
      imgIndex = 0;
    }
    currentImgElement.elt.src = imgs[imgs.length - 1][imgIndex].images.downsized.url;
  }
  // return false;
}

function keyPressed(){
  if(keyCode == RIGHT_ARROW){
    imgIndex = 0;
    currentImgElement.elt.src = nextImgs["synonym"][0].images.downsized.url;
    currentP.elt.value = nextSynonym;
    currentImgs = nextImgs["synonym"];

    if(nextSynonym != words["synonym"][words["synonym"].length - 1]){
      imgs["synonym"].push(nextImgs["synonym"]);
      imgs["hyponym"] = [nextImgs["synonym"]];
      imgs["hypernym"] = [nextImgs["synonym"]];

      words["synonym"].push(nextSynonym);
      words["hyponym"] = [nextSynonym];
      words["hypernym"] = [nextSynonym];
    }

    console.log(words["synonym"]);
    generateNextWords(nextSynonym);
  }else if(keyCode == LEFT_ARROW){
    if(words["synonym"].length > 1){

      words["synonym"].pop();
      words["hyponym"] = [words["synonym"][words["synonym"].length - 1]];
      words["hypernym"] = [words["synonym"][words["synonym"].length - 1]];

      imgs["synonym"].pop();
      imgs["hyponym"] = [imgs["synonym"][imgs["synonym"].length - 1]];
      imgs["hypernym"] = [imgs["synonym"][imgs["synonym"].length - 1]];
      imgIndex = 0;
    }
    currentImgElement.elt.src = imgs["synonym"][imgs["synonym"].length - 1][imgIndex].images.downsized.url;
    currentImgs = imgs["synonym"][imgs["synonym"].length - 1];
    currentP.elt.value = words["synonym"][words["synonym"].length - 1];

    console.log(words["synonym"]);
    generateNextWords(words["synonym"][words["synonym"].length - 1]);
  }else if(keyCode == UP_ARROW){
    imgIndex = 0;
    if(imgs["hyponym"].length > 1){
      words["hyponym"].pop();
      words["synonym"] = [words["hyponym"][words["hyponym"].length - 1]];

      imgs["hyponym"].pop();
      imgs["synonym"] = [imgs["hyponym"][imgs["hyponym"].length - 1]];

      currentImgElement.elt.src = imgs["hyponym"][imgs["hyponym"].length - 1][imgIndex].images.downsized.url;
      currentImgs = imgs["hyponym"][imgs["hyponym"].length - 1];
      currentP.elt.value = words["hyponym"][words["hyponym"].length - 1];

      console.log(words["hyponym"]);
      generateNextWords(words["hyponym"][words["hyponym"].length - 1]);
    }else{
      currentImgElement.elt.src = nextImgs["hypernym"][0].images.downsized.url;
      currentP.elt.value = nextHyper;
      currentImgs = nextImgs["hypernym"];

      if(nextHyper != words["hypernym"][words["hypernym"].length - 1]){
        imgs["hypernym"].push(nextImgs["hypernym"]);
        imgs["synonym"] = [imgs["hypernym"][imgs["hypernym"].length - 1]];

        words["hypernym"].push(nextHyper);
        words["synonym"] = [words["hypernym"][words["hypernym"].length - 1]];
      }

      console.log(words["hypernym"]);
      generateNextWords(nextHyper);
    }
  }else if(keyCode == DOWN_ARROW){
    imgIndex = 0;
    if(imgs["hypernym"].length > 1){
      words["hypernym"].pop();
      words["synonym"] = [words["hypernym"][words["hypernym"].length - 1]];

      imgs["hypernym"].pop();
      imgs["synonym"] = [imgs["hypernym"][imgs["hypernym"].length - 1]];

      currentImgElement.elt.src = imgs["hypernym"][imgs["hypernym"].length - 1][imgIndex].images.downsized.url;
      currentImgs = imgs["hypernym"][imgs["hypernym"].length - 1];
      currentP.elt.value = words["hypernym"][words["hypernym"].length - 1];

      console.log(words["hypernym"]);
      generateNextWords(words["hypernym"][words["hypernym"].length - 1]);
    }else{
      currentImgElement.elt.src = nextImgs["hyponym"][0].images.downsized.url;
      currentP.elt.value = nextHypo;
      currentImgs = nextImgs["hyponym"];

      if(nextHypo != words["hyponym"][words["hyponym"].length - 1]){
        imgs["hyponym"].push(nextImgs["hyponym"]);
        imgs["synonym"] = [imgs["hyponym"][imgs["hyponym"].length - 1]];
        words["hyponym"].push(nextHypo);
        words["synonym"] = [words["hyponym"][words["hyponym"].length - 1]];
      }

      console.log(words["hyponym"]);
      generateNextWords(nextHypo);
    }
  }else if(keyCode == 32){
    if(imgIndex < currentImgs.length - 1){
      imgIndex++;
    }else{
      imgIndex = 0;
    }
    currentImgElement.elt.src = currentImgs[imgIndex].images.downsized.url;
  }else{
    console.log(keyCode);
  }
  // return false;
}

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlcyI6WyJtYWluLmpzIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBzZWVkID0gXCJidWlsZGluZ1wiO1xuXG52YXIgZ2lmVXJsID0gXCJodHRwOi8vYXBpLmdpcGh5LmNvbS92MS9naWZzL3NlYXJjaD9xPVwiICsgc2VlZCArIFwiJmFwaV9rZXk9OGxBUkYwY2dHMGxZNlpNZlo2bjJHRVljb0h2WGc0V1hcIjtcbnZhciB3b3JkbmlrS2V5ID0gXCI0N2RjY2Y4YmU0NGQyN2UzM2UwMDAwOTVmYzAwODAwZDkxMDc3OWI4NjhlMTliMWRjXCI7XG5cbnZhciB3b3JkcyA9IHt9O1xudmFyIGltZ3MgPSB7fTtcblxudmFyIGN1cnJlbnRJbWdzID0gW107XG52YXIgaW1nSW5kZXggPSAwO1xudmFyIGN1cnJlbnRJbWdFbGVtZW50O1xudmFyIGN1cnJlbnRQO1xuXG52YXIgbmV4dEltZ3MgPSB7fTtcbnZhciBuZXh0U3lub255bTtcbnZhciBuZXh0SHlwbztcbnZhciBuZXh0SHlwZXI7XG5cbnZhciBoZWxwaW5nID0gZmFsc2U7XG5cbmZ1bmN0aW9uIHNldHVwKCl7XG4gIG5vQ2FudmFzKCk7XG5cbiAgdmFyIGhlbHAgPSBzZWxlY3QoXCIjaGVscFwiKTtcbiAgLy8gaGVscC5oaWRlKCk7XG4gIHZhciBoZWxwQnV0dG9uID0gc2VsZWN0KFwiaVwiKTtcbiAgaGVscEJ1dHRvbi5tb3VzZUNsaWNrZWQoZnVuY3Rpb24oKXtcbiAgICBpZighaGVscGluZyl7XG4gICAgICBoZWxwLnNob3coKTtcbiAgICAgIGhlbHBpbmcgPSB0cnVlO1xuICAgIH1lbHNle1xuICAgICAgaGVscC5oaWRlKCk7XG4gICAgICBoZWxwaW5nID0gZmFsc2U7XG4gICAgfVxuICB9KTtcblxuICBpZih3aW5kb3cubG9jYXRpb24uaGFzaC5sZW5ndGggPiAxKXtcbiAgICBzZWVkID0gd2luZG93LmxvY2F0aW9uLmhhc2guc2xpY2UoMSk7XG4gICAgZ2lmVXJsID0gXCJodHRwOi8vYXBpLmdpcGh5LmNvbS92MS9naWZzL3NlYXJjaD9xPVwiICsgc2VlZCArIFwiJmFwaV9rZXk9OGxBUkYwY2dHMGxZNlpNZlo2bjJHRVljb0h2WGc0V1hcIjtcbiAgfVxuICBsb2FkSlNPTihnaWZVcmwsIGZ1bmN0aW9uKGdpcGh5KXtcbiAgICBjdXJyZW50SW1nRWxlbWVudCA9IGNyZWF0ZUltZyhnaXBoeS5kYXRhWzBdLmltYWdlcy5kb3duc2l6ZWQudXJsKTtcbiAgICBjdXJyZW50UCA9IGNyZWF0ZUlucHV0KHNlZWQpO1xuICAgIC8vIGNvbnNvbGUubG9nKGN1cnJlbnRQKTtcbiAgICBjdXJyZW50UC5jaGFuZ2VkKGZ1bmN0aW9uKCl7XG4gICAgICBjdXJyZW50UC5lbHQuYmx1cigpO1xuICAgICAgc2VlZCA9IGN1cnJlbnRQLmVsdC52YWx1ZTtcbiAgICAgIGNvbnNvbGUubG9nKFwic2VlZDpcIiwgc2VlZCk7XG4gICAgICBnaWZVcmwgPSBcImh0dHA6Ly9hcGkuZ2lwaHkuY29tL3YxL2dpZnMvc2VhcmNoP3E9XCIgKyBzZWVkICsgXCImYXBpX2tleT04bEFSRjBjZ0cwbFk2Wk1mWjZuMkdFWWNvSHZYZzRXWFwiO1xuICAgICAgaW1nc1tcInN5bm9ueW1cIl0gPSBbXTtcbiAgICAgIGltZ3NbXCJoeXBvbnltXCJdID0gW107XG4gICAgICBpbWdzW1wiaHlwZXJueW1cIl0gPSBbXTtcbiAgICAgIHdvcmRzW1wic3lub255bVwiXSA9IFtdO1xuICAgICAgd29yZHNbXCJoeXBvbnltXCJdID0gW107XG4gICAgICB3b3Jkc1tcImh5cGVybnltXCJdID0gW107XG4gICAgICBpbWdJbmRleCA9IDA7XG4gICAgICBsb2FkSlNPTihnaWZVcmwsIGZ1bmN0aW9uKGdpcGh5KXtcbiAgICAgICAgaWYoZ2lwaHkuZGF0YSl7XG4gICAgICAgICAgY3VycmVudEltZ0VsZW1lbnQuZWx0LnNyYyA9IGdpcGh5LmRhdGFbMF0uaW1hZ2VzLmRvd25zaXplZC51cmw7XG4gICAgICAgICAgd29yZHNbXCJzeW5vbnltXCJdLnB1c2goc2VlZCk7XG4gICAgICAgICAgd29yZHNbXCJoeXBvbnltXCJdLnB1c2goc2VlZCk7XG4gICAgICAgICAgd29yZHNbXCJoeXBlcm55bVwiXS5wdXNoKHNlZWQpO1xuICAgICAgICAgIGltZ3NbXCJzeW5vbnltXCJdLnB1c2goZ2lwaHkuZGF0YSk7XG4gICAgICAgICAgaW1nc1tcImh5cG9ueW1cIl0ucHVzaChnaXBoeS5kYXRhKTtcbiAgICAgICAgICBpbWdzW1wiaHlwZXJueW1cIl0ucHVzaChnaXBoeS5kYXRhKTtcbiAgICAgICAgICBjdXJyZW50SW1ncyA9IGdpcGh5LmRhdGE7XG4gICAgICAgICAgZ2VuZXJhdGVOZXh0V29yZHMoc2VlZCk7XG4gICAgICAgIH1lbHNle1xuICAgICAgICAgIGNvbnNvbGUubG9nKFwid2UgZmFpbGVkXCIpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgICBpbWdzW1wic3lub255bVwiXSA9IFtdO1xuICAgIGltZ3NbXCJoeXBvbnltXCJdID0gW107XG4gICAgaW1nc1tcImh5cGVybnltXCJdID0gW107XG4gICAgd29yZHNbXCJzeW5vbnltXCJdID0gW107XG4gICAgd29yZHNbXCJoeXBvbnltXCJdID0gW107XG4gICAgd29yZHNbXCJoeXBlcm55bVwiXSA9IFtdO1xuICAgIG5leHRJbWdzW1wic3lub255bVwiXSA9IFtdO1xuICAgIG5leHRJbWdzW1wiaHlwb255bVwiXSA9IFtdO1xuICAgIG5leHRJbWdzW1wiaHlwZXJueW1cIl0gPSBbXTtcbiAgICB3b3Jkc1tcInN5bm9ueW1cIl0ucHVzaChzZWVkKTtcbiAgICB3b3Jkc1tcImh5cG9ueW1cIl0ucHVzaChzZWVkKTtcbiAgICB3b3Jkc1tcImh5cGVybnltXCJdLnB1c2goc2VlZCk7XG4gICAgaW1nc1tcInN5bm9ueW1cIl0ucHVzaChnaXBoeS5kYXRhKTtcbiAgICBpbWdzW1wiaHlwb255bVwiXS5wdXNoKGdpcGh5LmRhdGEpO1xuICAgIGltZ3NbXCJoeXBlcm55bVwiXS5wdXNoKGdpcGh5LmRhdGEpO1xuICAgIGN1cnJlbnRJbWdzID0gZ2lwaHkuZGF0YTtcbiAgICBnZW5lcmF0ZU5leHRXb3JkcyhzZWVkKTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlR2lwaHlGdW5jdGlvbih0eXBlKXtcbiAgcmV0dXJuIGZ1bmN0aW9uKGdpcGh5KXtcbiAgICBpZihnaXBoeS5kYXRhLmxlbmd0aCA+IDApe1xuICAgICAgbmV4dEltZ3NbdHlwZV0gPSBnaXBoeS5kYXRhO1xuICAgIH1lbHNle1xuICAgICAgZ2VuZXJhdGVXb3JkKHdvcmRzW3R5cGVdW3dvcmRzLmxlbmd0aCAtIDFdLCB0eXBlKTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gZ2VuZXJhdGVXb3JkbmlrTGluayh3b3JkKXtcbiAgcmV0dXJuIFwiaHR0cDovL2FwaS53b3JkbmlrLmNvbTo4MC92NC93b3JkLmpzb24vXCIgKyB3b3JkICsgXCIvcmVsYXRlZFdvcmRzP3VzZUNhbm9uaWNhbD1mYWxzZSZyZWxhdGlvbnNoaXBUeXBlcz1zeW5vbnltJmxpbWl0UGVyUmVsYXRpb25zaGlwVHlwZT0xMCZhcGlfa2V5PVwiICsgd29yZG5pa0tleTtcbn1cblxuZnVuY3Rpb24gZ2VuZXJhdGVEYXRhTXVzZUxpbmsocGFyYW1zKXtcbiAgdmFyIHF1ZXJ5TGluayA9IFwiaHR0cDovL2FwaS5kYXRhbXVzZS5jb20vd29yZHM/XCI7XG4gIGZvcih2YXIgaSA9IDA7IGkgPCBwYXJhbXMubGVuZ3RoOyBpKyspe1xuICAgIGlmKGkgPiAwKXtcbiAgICAgIHF1ZXJ5TGluayArPSBcIiZcIjtcbiAgICB9XG4gICAgcXVlcnlMaW5rICs9IHBhcmFtc1tpXTtcbiAgfVxuICByZXR1cm4gcXVlcnlMaW5rO1xufVxuXG5mdW5jdGlvbiBnZW5lcmF0ZU5leHRXb3Jkcyh3b3JkKXtcbiAgZ2VuZXJhdGVTeW5vbnltKHdvcmQpO1xuICBnZW5lcmF0ZUh5cG9ueW0od29yZCk7XG4gIGdlbmVyYXRlSHlwZXJueW0od29yZCk7XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlV29yZCh3b3JkLCB0eXBlKXtcbiAgaWYodHlwZSA9PSBcInN5bm9ueW1cIil7XG4gICAgZ2VuZXJhdGVTeW5vbnltKHdvcmQpO1xuICB9ZWxzZSBpZih0eXBlID09IFwiaHlwZXJueW1cIil7XG4gICAgZ2VuZXJhdGVIeXBlcm55bSh3b3JkKTtcbiAgfWVsc2UgaWYodHlwZSA9PSBcImh5cG9ueW1cIil7XG4gICAgZ2VuZXJhdGVIeXBvbnltKHdvcmQpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlU3lub255bSh3b3JkKXtcbiAgbG9hZEpTT04oZ2VuZXJhdGVXb3JkbmlrTGluayh3b3JkKSwgZnVuY3Rpb24oZGF0YSl7XG4gICAgaWYoZGF0YVswXSAmJiBkYXRhWzBdLndvcmRzICYmIGRhdGFbMF0ud29yZHMubGVuZ3RoID4gMCl7XG4gICAgICBuZXh0U3lub255bSA9IGRhdGFbMF0ud29yZHNbZmxvb3IocmFuZG9tKGRhdGFbMF0ud29yZHMubGVuZ3RoKSldO1xuICAgIH1lbHNle1xuICAgICAgbmV4dFN5bm9ueW0gPSB3b3Jkc1tcInN5bm9ueW1cIl1bd29yZHNbXCJzeW5vbnltXCJdLmxlbmd0aCAtIDFdO1xuICAgIH1cbiAgICB2YXIgbmV4dFVybCA9IFwiaHR0cDovL2FwaS5naXBoeS5jb20vdjEvZ2lmcy9zZWFyY2g/cT1cIiArIG5leHRTeW5vbnltICsgXCImYXBpX2tleT04bEFSRjBjZ0cwbFk2Wk1mWjZuMkdFWWNvSHZYZzRXWFwiO1xuICAgIGxvYWRKU09OKG5leHRVcmwsIGdlbmVyYXRlR2lwaHlGdW5jdGlvbihcInN5bm9ueW1cIikpO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gZ2VuZXJhdGVIeXBvbnltKHdvcmQpe1xuICBsb2FkSlNPTihnZW5lcmF0ZURhdGFNdXNlTGluayhbXCJyZWxfZ2VuPVwiICsgd29yZF0pLCBmdW5jdGlvbihkYXRhKXtcbiAgICBpZihkYXRhLmxlbmd0aCA+IDApe1xuICAgICAgbmV4dEh5cG8gPSBkYXRhW2Zsb29yKHJhbmRvbShkYXRhLmxlbmd0aCkpXS53b3JkO1xuICAgIH1lbHNle1xuICAgICAgbmV4dEh5cG8gPSB3b3Jkc1tcImh5cG9ueW1cIl1bd29yZHNbXCJoeXBvbnltXCJdLmxlbmd0aCAtIDFdO1xuICAgIH1cbiAgICB2YXIgbmV4dFVybCA9IFwiaHR0cDovL2FwaS5naXBoeS5jb20vdjEvZ2lmcy9zZWFyY2g/cT1cIiArIG5leHRIeXBvICsgXCImYXBpX2tleT04bEFSRjBjZ0cwbFk2Wk1mWjZuMkdFWWNvSHZYZzRXWFwiO1xuICAgIGxvYWRKU09OKG5leHRVcmwsIGdlbmVyYXRlR2lwaHlGdW5jdGlvbihcImh5cG9ueW1cIikpO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gZ2VuZXJhdGVIeXBlcm55bSh3b3JkKXtcbiAgbG9hZEpTT04oZ2VuZXJhdGVEYXRhTXVzZUxpbmsoW1wicmVsX3NwYz1cIiArIHdvcmRdKSwgZnVuY3Rpb24oZGF0YSl7XG4gICAgaWYoZGF0YS5sZW5ndGggPiAwKXtcbiAgICAgIG5leHRIeXBlciA9IGRhdGFbZmxvb3IocmFuZG9tKGRhdGEubGVuZ3RoKSldLndvcmQ7XG4gICAgfWVsc2V7XG4gICAgICBuZXh0SHlwZXIgPSB3b3Jkc1tcImh5cGVybnltXCJdW3dvcmRzW1wiaHlwZXJueW1cIl0ubGVuZ3RoIC0gMV07XG4gICAgfVxuICAgIHZhciBuZXh0VXJsID0gXCJodHRwOi8vYXBpLmdpcGh5LmNvbS92MS9naWZzL3NlYXJjaD9xPVwiICsgbmV4dEh5cGVyICsgXCImYXBpX2tleT04bEFSRjBjZ0cwbFk2Wk1mWjZuMkdFWWNvSHZYZzRXWFwiO1xuICAgIGxvYWRKU09OKG5leHRVcmwsIGdlbmVyYXRlR2lwaHlGdW5jdGlvbihcImh5cGVybnltXCIpKTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIG1vdXNlUmVsZWFzZWQoKXtcbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5mdW5jdGlvbiB0b3VjaEVuZGVkKCl7XG4gIGlmKHdpbk1vdXNlWCA+IDMgKiB3aW5kb3cuaW5uZXJXaWR0aCAvIDQpe1xuICAgIGltZ0luZGV4ID0gMDtcbiAgICBjdXJyZW50SW1nRWxlbWVudC5lbHQuc3JjID0gbmV4dEltZ3NbMF0uaW1hZ2VzLmRvd25zaXplZC51cmw7XG4gICAgLy8gY3VycmVudFAuZWx0LmlubmVyVGV4dCA9IG5leHRTeW5vbnltO1xuICAgIGN1cnJlbnRQLmVsdC52YWx1ZSA9IG5leHRTeW5vbnltO1xuICAgIGltZ3MucHVzaChuZXh0SW1ncyk7XG4gICAgd29yZHMucHVzaChuZXh0U3lub255bSk7XG4gICAgY29uc29sZS5sb2cod29yZHMpO1xuICAgIGdlbmVyYXRlU3lub255bShuZXh0U3lub255bSk7XG4gIH1lbHNlIGlmKHdpbk1vdXNlWCA8IHdpbmRvdy5pbm5lcldpZHRoIC8gNCl7XG4gICAgaWYod29yZHMubGVuZ3RoID4gMSl7XG4gICAgICB3b3Jkcy5wb3AoKTtcbiAgICAgIGltZ3MucG9wKCk7XG4gICAgICBpbWdJbmRleCA9IDA7XG4gICAgfVxuICAgIGN1cnJlbnRJbWdFbGVtZW50LmVsdC5zcmMgPSBpbWdzW2ltZ3MubGVuZ3RoIC0gMV1baW1nSW5kZXhdLmltYWdlcy5kb3duc2l6ZWQudXJsO1xuICAgIC8vIGN1cnJlbnRQLmVsdC5pbm5lclRleHQgPSB3b3Jkc1t3b3Jkcy5sZW5ndGggLSAxXTtcbiAgICBjdXJyZW50UC5lbHQudmFsdWUgPSB3b3Jkc1t3b3Jkcy5sZW5ndGggLSAxXTtcbiAgICBnZW5lcmF0ZVN5bm9ueW0od29yZHNbd29yZHMubGVuZ3RoIC0gMV0pO1xuICB9ZWxzZXtcbiAgICBpZihpbWdJbmRleCA8IGltZ3NbaW1ncy5sZW5ndGggLSAxXS5sZW5ndGggLSAxKXtcbiAgICAgIGltZ0luZGV4Kys7XG4gICAgfWVsc2V7XG4gICAgICBpbWdJbmRleCA9IDA7XG4gICAgfVxuICAgIGN1cnJlbnRJbWdFbGVtZW50LmVsdC5zcmMgPSBpbWdzW2ltZ3MubGVuZ3RoIC0gMV1baW1nSW5kZXhdLmltYWdlcy5kb3duc2l6ZWQudXJsO1xuICB9XG4gIC8vIHJldHVybiBmYWxzZTtcbn1cblxuZnVuY3Rpb24ga2V5UHJlc3NlZCgpe1xuICBpZihrZXlDb2RlID09IFJJR0hUX0FSUk9XKXtcbiAgICBpbWdJbmRleCA9IDA7XG4gICAgY3VycmVudEltZ0VsZW1lbnQuZWx0LnNyYyA9IG5leHRJbWdzW1wic3lub255bVwiXVswXS5pbWFnZXMuZG93bnNpemVkLnVybDtcbiAgICBjdXJyZW50UC5lbHQudmFsdWUgPSBuZXh0U3lub255bTtcbiAgICBjdXJyZW50SW1ncyA9IG5leHRJbWdzW1wic3lub255bVwiXTtcblxuICAgIGlmKG5leHRTeW5vbnltICE9IHdvcmRzW1wic3lub255bVwiXVt3b3Jkc1tcInN5bm9ueW1cIl0ubGVuZ3RoIC0gMV0pe1xuICAgICAgaW1nc1tcInN5bm9ueW1cIl0ucHVzaChuZXh0SW1nc1tcInN5bm9ueW1cIl0pO1xuICAgICAgaW1nc1tcImh5cG9ueW1cIl0gPSBbbmV4dEltZ3NbXCJzeW5vbnltXCJdXTtcbiAgICAgIGltZ3NbXCJoeXBlcm55bVwiXSA9IFtuZXh0SW1nc1tcInN5bm9ueW1cIl1dO1xuXG4gICAgICB3b3Jkc1tcInN5bm9ueW1cIl0ucHVzaChuZXh0U3lub255bSk7XG4gICAgICB3b3Jkc1tcImh5cG9ueW1cIl0gPSBbbmV4dFN5bm9ueW1dO1xuICAgICAgd29yZHNbXCJoeXBlcm55bVwiXSA9IFtuZXh0U3lub255bV07XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2cod29yZHNbXCJzeW5vbnltXCJdKTtcbiAgICBnZW5lcmF0ZU5leHRXb3JkcyhuZXh0U3lub255bSk7XG4gIH1lbHNlIGlmKGtleUNvZGUgPT0gTEVGVF9BUlJPVyl7XG4gICAgaWYod29yZHNbXCJzeW5vbnltXCJdLmxlbmd0aCA+IDEpe1xuXG4gICAgICB3b3Jkc1tcInN5bm9ueW1cIl0ucG9wKCk7XG4gICAgICB3b3Jkc1tcImh5cG9ueW1cIl0gPSBbd29yZHNbXCJzeW5vbnltXCJdW3dvcmRzW1wic3lub255bVwiXS5sZW5ndGggLSAxXV07XG4gICAgICB3b3Jkc1tcImh5cGVybnltXCJdID0gW3dvcmRzW1wic3lub255bVwiXVt3b3Jkc1tcInN5bm9ueW1cIl0ubGVuZ3RoIC0gMV1dO1xuXG4gICAgICBpbWdzW1wic3lub255bVwiXS5wb3AoKTtcbiAgICAgIGltZ3NbXCJoeXBvbnltXCJdID0gW2ltZ3NbXCJzeW5vbnltXCJdW2ltZ3NbXCJzeW5vbnltXCJdLmxlbmd0aCAtIDFdXTtcbiAgICAgIGltZ3NbXCJoeXBlcm55bVwiXSA9IFtpbWdzW1wic3lub255bVwiXVtpbWdzW1wic3lub255bVwiXS5sZW5ndGggLSAxXV07XG4gICAgICBpbWdJbmRleCA9IDA7XG4gICAgfVxuICAgIGN1cnJlbnRJbWdFbGVtZW50LmVsdC5zcmMgPSBpbWdzW1wic3lub255bVwiXVtpbWdzW1wic3lub255bVwiXS5sZW5ndGggLSAxXVtpbWdJbmRleF0uaW1hZ2VzLmRvd25zaXplZC51cmw7XG4gICAgY3VycmVudEltZ3MgPSBpbWdzW1wic3lub255bVwiXVtpbWdzW1wic3lub255bVwiXS5sZW5ndGggLSAxXTtcbiAgICBjdXJyZW50UC5lbHQudmFsdWUgPSB3b3Jkc1tcInN5bm9ueW1cIl1bd29yZHNbXCJzeW5vbnltXCJdLmxlbmd0aCAtIDFdO1xuXG4gICAgY29uc29sZS5sb2cod29yZHNbXCJzeW5vbnltXCJdKTtcbiAgICBnZW5lcmF0ZU5leHRXb3Jkcyh3b3Jkc1tcInN5bm9ueW1cIl1bd29yZHNbXCJzeW5vbnltXCJdLmxlbmd0aCAtIDFdKTtcbiAgfWVsc2UgaWYoa2V5Q29kZSA9PSBVUF9BUlJPVyl7XG4gICAgaW1nSW5kZXggPSAwO1xuICAgIGlmKGltZ3NbXCJoeXBvbnltXCJdLmxlbmd0aCA+IDEpe1xuICAgICAgd29yZHNbXCJoeXBvbnltXCJdLnBvcCgpO1xuICAgICAgd29yZHNbXCJzeW5vbnltXCJdID0gW3dvcmRzW1wiaHlwb255bVwiXVt3b3Jkc1tcImh5cG9ueW1cIl0ubGVuZ3RoIC0gMV1dO1xuXG4gICAgICBpbWdzW1wiaHlwb255bVwiXS5wb3AoKTtcbiAgICAgIGltZ3NbXCJzeW5vbnltXCJdID0gW2ltZ3NbXCJoeXBvbnltXCJdW2ltZ3NbXCJoeXBvbnltXCJdLmxlbmd0aCAtIDFdXTtcblxuICAgICAgY3VycmVudEltZ0VsZW1lbnQuZWx0LnNyYyA9IGltZ3NbXCJoeXBvbnltXCJdW2ltZ3NbXCJoeXBvbnltXCJdLmxlbmd0aCAtIDFdW2ltZ0luZGV4XS5pbWFnZXMuZG93bnNpemVkLnVybDtcbiAgICAgIGN1cnJlbnRJbWdzID0gaW1nc1tcImh5cG9ueW1cIl1baW1nc1tcImh5cG9ueW1cIl0ubGVuZ3RoIC0gMV07XG4gICAgICBjdXJyZW50UC5lbHQudmFsdWUgPSB3b3Jkc1tcImh5cG9ueW1cIl1bd29yZHNbXCJoeXBvbnltXCJdLmxlbmd0aCAtIDFdO1xuXG4gICAgICBjb25zb2xlLmxvZyh3b3Jkc1tcImh5cG9ueW1cIl0pO1xuICAgICAgZ2VuZXJhdGVOZXh0V29yZHMod29yZHNbXCJoeXBvbnltXCJdW3dvcmRzW1wiaHlwb255bVwiXS5sZW5ndGggLSAxXSk7XG4gICAgfWVsc2V7XG4gICAgICBjdXJyZW50SW1nRWxlbWVudC5lbHQuc3JjID0gbmV4dEltZ3NbXCJoeXBlcm55bVwiXVswXS5pbWFnZXMuZG93bnNpemVkLnVybDtcbiAgICAgIGN1cnJlbnRQLmVsdC52YWx1ZSA9IG5leHRIeXBlcjtcbiAgICAgIGN1cnJlbnRJbWdzID0gbmV4dEltZ3NbXCJoeXBlcm55bVwiXTtcblxuICAgICAgaWYobmV4dEh5cGVyICE9IHdvcmRzW1wiaHlwZXJueW1cIl1bd29yZHNbXCJoeXBlcm55bVwiXS5sZW5ndGggLSAxXSl7XG4gICAgICAgIGltZ3NbXCJoeXBlcm55bVwiXS5wdXNoKG5leHRJbWdzW1wiaHlwZXJueW1cIl0pO1xuICAgICAgICBpbWdzW1wic3lub255bVwiXSA9IFtpbWdzW1wiaHlwZXJueW1cIl1baW1nc1tcImh5cGVybnltXCJdLmxlbmd0aCAtIDFdXTtcblxuICAgICAgICB3b3Jkc1tcImh5cGVybnltXCJdLnB1c2gobmV4dEh5cGVyKTtcbiAgICAgICAgd29yZHNbXCJzeW5vbnltXCJdID0gW3dvcmRzW1wiaHlwZXJueW1cIl1bd29yZHNbXCJoeXBlcm55bVwiXS5sZW5ndGggLSAxXV07XG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUubG9nKHdvcmRzW1wiaHlwZXJueW1cIl0pO1xuICAgICAgZ2VuZXJhdGVOZXh0V29yZHMobmV4dEh5cGVyKTtcbiAgICB9XG4gIH1lbHNlIGlmKGtleUNvZGUgPT0gRE9XTl9BUlJPVyl7XG4gICAgaW1nSW5kZXggPSAwO1xuICAgIGlmKGltZ3NbXCJoeXBlcm55bVwiXS5sZW5ndGggPiAxKXtcbiAgICAgIHdvcmRzW1wiaHlwZXJueW1cIl0ucG9wKCk7XG4gICAgICB3b3Jkc1tcInN5bm9ueW1cIl0gPSBbd29yZHNbXCJoeXBlcm55bVwiXVt3b3Jkc1tcImh5cGVybnltXCJdLmxlbmd0aCAtIDFdXTtcblxuICAgICAgaW1nc1tcImh5cGVybnltXCJdLnBvcCgpO1xuICAgICAgaW1nc1tcInN5bm9ueW1cIl0gPSBbaW1nc1tcImh5cGVybnltXCJdW2ltZ3NbXCJoeXBlcm55bVwiXS5sZW5ndGggLSAxXV07XG5cbiAgICAgIGN1cnJlbnRJbWdFbGVtZW50LmVsdC5zcmMgPSBpbWdzW1wiaHlwZXJueW1cIl1baW1nc1tcImh5cGVybnltXCJdLmxlbmd0aCAtIDFdW2ltZ0luZGV4XS5pbWFnZXMuZG93bnNpemVkLnVybDtcbiAgICAgIGN1cnJlbnRJbWdzID0gaW1nc1tcImh5cGVybnltXCJdW2ltZ3NbXCJoeXBlcm55bVwiXS5sZW5ndGggLSAxXTtcbiAgICAgIGN1cnJlbnRQLmVsdC52YWx1ZSA9IHdvcmRzW1wiaHlwZXJueW1cIl1bd29yZHNbXCJoeXBlcm55bVwiXS5sZW5ndGggLSAxXTtcblxuICAgICAgY29uc29sZS5sb2cod29yZHNbXCJoeXBlcm55bVwiXSk7XG4gICAgICBnZW5lcmF0ZU5leHRXb3Jkcyh3b3Jkc1tcImh5cGVybnltXCJdW3dvcmRzW1wiaHlwZXJueW1cIl0ubGVuZ3RoIC0gMV0pO1xuICAgIH1lbHNle1xuICAgICAgY3VycmVudEltZ0VsZW1lbnQuZWx0LnNyYyA9IG5leHRJbWdzW1wiaHlwb255bVwiXVswXS5pbWFnZXMuZG93bnNpemVkLnVybDtcbiAgICAgIGN1cnJlbnRQLmVsdC52YWx1ZSA9IG5leHRIeXBvO1xuICAgICAgY3VycmVudEltZ3MgPSBuZXh0SW1nc1tcImh5cG9ueW1cIl07XG5cbiAgICAgIGlmKG5leHRIeXBvICE9IHdvcmRzW1wiaHlwb255bVwiXVt3b3Jkc1tcImh5cG9ueW1cIl0ubGVuZ3RoIC0gMV0pe1xuICAgICAgICBpbWdzW1wiaHlwb255bVwiXS5wdXNoKG5leHRJbWdzW1wiaHlwb255bVwiXSk7XG4gICAgICAgIGltZ3NbXCJzeW5vbnltXCJdID0gW2ltZ3NbXCJoeXBvbnltXCJdW2ltZ3NbXCJoeXBvbnltXCJdLmxlbmd0aCAtIDFdXTtcbiAgICAgICAgd29yZHNbXCJoeXBvbnltXCJdLnB1c2gobmV4dEh5cG8pO1xuICAgICAgICB3b3Jkc1tcInN5bm9ueW1cIl0gPSBbd29yZHNbXCJoeXBvbnltXCJdW3dvcmRzW1wiaHlwb255bVwiXS5sZW5ndGggLSAxXV07XG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUubG9nKHdvcmRzW1wiaHlwb255bVwiXSk7XG4gICAgICBnZW5lcmF0ZU5leHRXb3JkcyhuZXh0SHlwbyk7XG4gICAgfVxuICB9ZWxzZSBpZihrZXlDb2RlID09IDMyKXtcbiAgICBpZihpbWdJbmRleCA8IGN1cnJlbnRJbWdzLmxlbmd0aCAtIDEpe1xuICAgICAgaW1nSW5kZXgrKztcbiAgICB9ZWxzZXtcbiAgICAgIGltZ0luZGV4ID0gMDtcbiAgICB9XG4gICAgY3VycmVudEltZ0VsZW1lbnQuZWx0LnNyYyA9IGN1cnJlbnRJbWdzW2ltZ0luZGV4XS5pbWFnZXMuZG93bnNpemVkLnVybDtcbiAgfWVsc2V7XG4gICAgY29uc29sZS5sb2coa2V5Q29kZSk7XG4gIH1cbiAgLy8gcmV0dXJuIGZhbHNlO1xufVxuIl0sImZpbGUiOiJtYWluLmpzIn0=

//# sourceMappingURL=main.min.js.map
